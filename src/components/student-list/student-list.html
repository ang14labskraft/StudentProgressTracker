<div class="student-list-container">
    <h2>Student List</h2>

    <!-- Loading State -->
    @if (loading) {
        <div class="loading">
            Loading students...
        </div>
    }

    <!-- Error State -->
    @if (error) {
        <div class="error">
            {{ error }}
        </div>
    }

    <!-- Data State -->
    @if (students.length > 0) {
        <div class="header-container">
            <div class="filters-container">
                <div class="filter-group search-field">
                    <span class="material-icons-round search-icon">search</span>
                    <input type="text" 
                           [(ngModel)]="filters.name" 
                           (input)="applyFilters()"
                           placeholder="Search students..."
                           class="filter-input">
                </div>
                <div class="filter-group">
                    <select [(ngModel)]="filters.class" 
                            (change)="applyFilters()"
                            class="filter-select">
                        <option value="">All Classes</option>
                        @for (class of uniqueClasses; track class) {
                            <option [value]="class">Class {{ class }}</option>
                        }
                    </select>
                </div>
                <div class="filter-group">
                    <select [(ngModel)]="filters.section" 
                            (change)="applyFilters()"
                            class="filter-select">
                        <option value="">All Sections</option>
                        @for (section of uniqueSections; track section) {
                            <option [value]="section">Section {{ section }}</option>
                        }
                    </select>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="student-table">
                <thead>
                    <tr>
                        <th (click)="sort('name')" class="sortable">
                            Full Name
                            <span class="sort-icon">
                                {{ getSortIcon('name') }}
                            </span>
                        </th>
                        <th (click)="sort('firstName')" class="sortable">
                            First Name
                            <span class="sort-icon">
                                {{ getSortIcon('firstName') }}
                            </span>
                        </th>
                        <th (click)="sort('lastName')" class="sortable">
                            Last Name
                            <span class="sort-icon">
                                {{ getSortIcon('lastName') }}
                            </span>
                        </th>
                        <th (click)="sort('class')" class="sortable">
                            Class
                            <span class="sort-icon">
                                {{ getSortIcon('class') }}
                            </span>
                        </th>
                        <th (click)="sort('section')" class="sortable">
                            Section
                            <span class="sort-icon">
                                {{ getSortIcon('section') }}
                            </span>
                        </th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @for (student of filteredStudents; track student.id) {
                        <tr>
                            <td>{{ student.name }}</td>
                            <td>{{ student.firstName }}</td>
                            <td>{{ student.lastName }}</td>
                            <td>{{ student.class }}</td>
                            <td>{{ student.section }}</td>
                            <td class="actions">
                                <button class="btn-icon btn-view" [routerLink]="['/details', student.id]" title="View Details">
                                    <span class="material-icons-round">visibility</span>
                                </button>
                                <button class="btn-icon btn-edit" [routerLink]="['/edit', student.id]" title="Edit Student">
                                    <span class="material-icons-round">edit</span>
                                </button>
                                <button class="btn-icon btn-delete" (click)="deleteStudent(student.id)" title="Delete Student">
                                    <span class="material-icons-round">delete_outline</span>
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    } @else if (!loading && !error) {
        <div class="no-data">
            No students found. Please add some students.
        </div>
    }
</div>
<app-chat></app-chat>